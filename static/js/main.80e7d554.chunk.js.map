{"version":3,"sources":["logo.svg","utilities/src/time-overview.js","utilities/src/comparison.js","utilities/src/timelines.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","Kapsule","props","width","default","height","margins","top","right","bottom","left","scale","domainRange","currentSelection","tickFormat","onChange","selectionStart","selectionEnd","init","el","state","xGrid","d3AxisBottom","xAxis","tickPadding","brush","d3BrushX","handleSize","on","d3Event","sourceEvent","selection","map","invert","domain","apply","Object","toConsumableArray","svg","d3Select","append","attr","brusher","update","brushWidth","brushHeight","range","tickSize","select","concat","call","selectAll","extent","move","alphaNumCmp","a","b","alist","split","blist","length","pop","i","len","Math","max","match","toLowerCase","data","rawData","completeStructData","completeFlatData","totalNLines","dateObjs","timeRange","Date","ilen","group","push","lines","d","label","j","jlen","k","klen","val","labelVal","hasOwnProperty","parseData","zoomX","d3Min","d3Max","zoomY","overviewArea","window","innerWidth","maxHeight","maxLineHeight","leftMargin","rightMargin","topMargin","bottomMargin","useUtc","xTickFormat","dateMarker","timeFormat","triggerUpdate","dispatch","detail","redraw","minSegmentDuration","zColorScale","d3ScaleSequential","interpolateRdYlBu","zQualitative","discrete","d3ScaleOrdinal","schemeCategory10","schemeSet3","zDataLabel","zScaleLabel","enableOverview","enableAnimations","transDuration","onZoom","onLabelClick","onSegmentClick","methods","getNLines","s","nLines","getTotalNLines","getVisibleStructure","structData","getSvg","node","parentNode","html","zoomYLabels","_","this","label2Y","y2Label","y","cntDwn","getIdxLine","grpData","idx","useIdxAfterIfNotFound","subIdxNotFound","lenI","grpCmp","grpCmpFunction","lenJ","cmpRes","labelCmpFunction","sort","_rerender","sortAlpha","asc","alphaCmp","sortChrono","buildIdx","accessFunction","_loop","key","itmList","filter","timeCmp","aT","bT","getTime","getCmpFunction","grpIdx","lblIdx","lblCmp","overviewDomain","refresh","stateInit","overviewHeight","minLabelFont","groupBkgGradient","yScale","grpScale","yAxis","grpAxis","dateMarkerLine","graph","overviewAreaElem","graphW","graphH","flatData","elem","d3ScalePoint","d3AxisTop","d3AxisRight","d3AxisLeft","invertOrdinal","groupGradId","Gradient","colorScale","d3ScaleLinear","angle","id","axises","colorLegend","ColorLegend","TimeOverview","startTime","endTime","min","cmpFunc","scDomain","scRange","d3Range","bias","round","buildDomStructure","groupTooltip","d3Tip","direction","offset","style","leftPush","xScale","topPush","lineTooltip","rightPush","segmentTooltip","normVal","dateFormat","d3UtcFormat","d3TimeFormat","e","d3Mouse","disableHover","rect","startCoords","stopPropagation","newCoords","abs","d3Ascending","indexOf","classed","remove","endCoords","newDomainX","newDomainY","changeX","changeY","resetBtn","text","evData","prevZoomX","prevZoomY","newZoomX","newZoomY","_loop2","validLines","some","dd","groupData","slice","_ret2","applyFilters","parseInt","transition","duration","d3ScaleUtc","d3ScaleTime","clamp","copy","labels","_loop3","adjustYScale","cntLines","pos","adjustGrpScale","ticks","labelDisplayRatio","ceil","sqrt","tickVals","fontSize","maxChars","tickValues","reduceLabel","minHeight","floor","segms","reverse","substring","renderAxises","groups","exit","newGroups","enter","index","element","groupAxis","yRightAxis","show","hide","merge","parseFloat","renderGroups","maxElems","lineHeight","timelines","newSegments","MoveToFront","hoverEnlarge","renderTimelines","TextFitToBox","bbox","console","log","startDate","dateDiff","dateDiffInDay","Array","updateBorder","KPC60","BCM4","App","classCallCheck","possibleConstructorReturn","getPrototypeOf","todayDate","moment","toDate","dataJson","myColor","timelinesChart","TimelinesChart","document","getElementById","react_default","createElement","Component","Boolean","location","hostname","ReactDOM","render","src_App_0","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.80e7d554.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","/**\n * Based on http://bl.ocks.org/mbostock/6232620\n */\n\nimport Kapsule from 'kapsule';\nimport { brushX as d3BrushX } from 'd3-brush';\nimport { axisBottom as d3AxisBottom } from 'd3-axis';\nimport { event as d3Event, select as d3Select } from 'd3-selection';\n\nexport default Kapsule({\n  props: {\n    width: { default: 300 },\n    height: { default: 20 },\n    margins: { default: { top: 0, right: 0, bottom: 20, left: 0 }},\n    scale: {},\n    domainRange: {},\n    currentSelection: {},\n    tickFormat: {},\n    onChange: { default: (selectionStart, selectionEnd) => {}}\n  },\n  init(el, state) {\n    state.xGrid = d3AxisBottom()\n      .tickFormat('');\n\n    state.xAxis = d3AxisBottom()\n      .tickPadding(0);\n\n    state.brush = d3BrushX()\n      .handleSize(24)\n      .on('end', function() {\n        if (!d3Event.sourceEvent) return;\n\n        const selection = d3Event.selection ? d3Event.selection.map(state.scale.invert) : state.scale.domain();\n        state.onChange(...selection);\n      });\n\n    // Build dom\n    state.svg = d3Select(el).append('svg').attr('class', 'brusher');\n    const brusher = state.svg.append('g').attr('class', 'brusher-margins');\n    brusher.append('rect').attr('class', 'grid-background');\n    brusher.append('g').attr('class', 'x grid');\n    brusher.append('g').attr('class', 'x axis');\n    brusher.append('g').attr('class', 'brush');\n  },\n  update(state) {\n    if (state.domainRange[1] <= state.domainRange[0]) return;\n\n    const brushWidth = state.width - state.margins.left - state.margins.right,\n      brushHeight = state.height - state.margins.top - state.margins.bottom;\n\n    state.scale\n      .domain(state.domainRange)\n      .range([0, brushWidth]);\n\n    state.xAxis\n      .scale(state.scale)\n      .tickFormat(state.tickFormat);\n    state.xGrid\n      .scale(state.scale)\n      .tickSize(-brushHeight);\n\n    state.svg\n      .attr('width', state.width)\n      .attr('height', state.height);\n\n    state.svg.select('.brusher-margins')\n      .attr('transform', `translate(${state.margins.left},${state.margins.top})`);\n\n    state.svg.select('.grid-background')\n      .attr('width', brushWidth)\n      .attr('height', brushHeight);\n\n    state.svg.select('.x.grid')\n      .attr('transform', 'translate(0,' + brushHeight + ')')\n      .call(state.xGrid);\n\n    state.svg.select('.x.axis')\n      .attr(\"transform\", \"translate(0,\" + brushHeight + \")\")\n      .call(state.xAxis)\n      .selectAll('text').attr('y', 8);\n\n    state.svg.select('.brush')\n      .call(state.brush.extent([[0, 0], [brushWidth, brushHeight]]))\n      .call(state.brush.move, state.currentSelection.map(state.scale));\n  }\n});","function alphaNumCmp(a,b){\n  const alist = a.split(/(\\d+)/),\n    blist = b.split(/(\\d+)/);\n\n  if(alist.length && alist[alist.length-1] == '') alist.pop()\n  if(blist.length && blist[blist.length-1] == '') blist.pop()\n  // (alist.length && alist[alist.length-1] == '') ? alist.pop() : null; // remove the last element if empty\n  // (blist.length && blist[blist.length-1] == '') ? blist.pop() : null; // remove the last element if empty\n\n  for (let i = 0, len = Math.max(alist.length, blist.length); i < len;i++){\n    if (alist.length==i || blist.length==i) { // Out of bounds for one of the sides\n      return alist.length - blist.length;\n    }\n    if (alist[i] != blist[i]){ // find the first non-equal part\n      if (alist[i].match(/\\d/)) // if numeric\n      {\n        return (+alist[i])-(+blist[i]); // compare as number\n      } else {\n        return (alist[i].toLowerCase() > blist[i].toLowerCase())?1:-1; // compare as string\n      }\n    }\n  }\n  return 0;\n}\n\nexport { alphaNumCmp };","import './timelines.css';\n\nimport Kapsule from 'kapsule';\n\nimport {\n  ascending as d3Ascending,\n  max as d3Max,\n  min as d3Min,\n  range as d3Range\n} from 'd3-array';\nimport {\n  axisBottom as d3AxisBottom,\n  axisLeft as d3AxisLeft,\n  axisRight as d3AxisRight,\n  axisTop as d3AxisTop\n} from 'd3-axis';\nimport {\n  scaleLinear as d3ScaleLinear,\n  scaleOrdinal as d3ScaleOrdinal,\n  scaleSequential as d3ScaleSequential,\n  scalePoint as d3ScalePoint,\n  scaleTime as d3ScaleTime,\n  scaleUtc as d3ScaleUtc\n} from 'd3-scale';\n\nimport {\n  event as d3Event,\n  mouse as d3Mouse,\n  select as d3Select\n} from 'd3-selection';\nimport {\n  timeFormat as d3TimeFormat,\n  utcFormat as d3UtcFormat\n} from 'd3-time-format';\nimport d3Tip from 'd3-tip';\nimport { schemeCategory10, schemeSet3, interpolateRdYlBu } from 'd3-scale-chromatic';\n\nimport { moveToFront as MoveToFront, gradient as Gradient } from 'svg-utils';\nimport { fitToBox as TextFitToBox } from 'svg-text-fit';\nimport ColorLegend from 'd3-color-legend';\nimport TimeOverview from './time-overview.js';\nimport { alphaNumCmp } from './comparison.js';\n\nexport default Kapsule({\n  props: {\n    data: {\n      default: [],\n      onChange(data, state) {\n        parseData(data);\n\n        state.zoomX = [\n          d3Min(state.completeFlatData, d => d.timeRange[0]),\n          d3Max(state.completeFlatData, d => d.timeRange[1])\n        ];\n\n        state.zoomY = [null, null];\n\n        if (state.overviewArea) {\n          state.overviewArea\n            .domainRange(state.zoomX)\n            .currentSelection(state.zoomX);\n        }\n\n        //\n\n        function parseData(rawData) {\n\n          state.completeStructData = [];\n          state.completeFlatData = [];\n          state.totalNLines = 0;\n\n          const dateObjs = rawData.length?rawData[0].data[0].data[0].timeRange[0] instanceof Date:false;\n\n          for (let i=0, ilen=rawData.length; i<ilen; i++) {\n            const group = rawData[i].group;\n            state.completeStructData.push({\n              group: group,\n              lines: rawData[i].data.map(d => d.label)\n            });\n\n            for (let j= 0, jlen=rawData[i].data.length; j<jlen; j++) {\n              for (let k= 0, klen=rawData[i].data[j].data.length; k<klen; k++) {\n                state.completeFlatData.push({\n                  group: group,\n                  label: rawData[i].data[j].label,\n                  timeRange: (dateObjs\n                      ?rawData[i].data[j].data[k].timeRange\n                      :[new Date(rawData[i].data[j].data[k].timeRange[0]), new Date(rawData[i].data[j].data[k].timeRange[1])]\n                  ),\n                  val: rawData[i].data[j].data[k].val,\n                  labelVal: rawData[i].data[j].data[k][rawData[i].data[j].data[k].hasOwnProperty('labelVal')?'labelVal':'val']\n                });\n              }\n              state.totalNLines++;\n            }\n          }\n        }\n      }\n    },\n    width: { default: window.innerWidth },\n    maxHeight: { default: 640 },\n    maxLineHeight: { default: 12 },\n    leftMargin: { default: 90 },\n    rightMargin: { default: 100 },\n    topMargin: {default: 26 },\n    bottomMargin: {default: 30 },\n    useUtc: { default: false },\n    xTickFormat: {},\n    dateMarker: {},\n    timeFormat: { default: '%Y-%m-%d %-I:%M:%S %p', triggerUpdate: false },\n    zoomX: {  // Which time-range to show (null = min/max)\n      default: [null, null],\n      onChange(zoomX, state) {\n        if (state.svg)\n          state.svg.dispatch('zoom', { detail: {\n            zoomX: zoomX,\n            zoomY: null,\n            redraw: false\n          }});\n      }\n    },\n    zoomY: {  // Which lines to show (null = min/max) [0 indexed]\n      default: [null, null],\n      onChange(zoomY, state) {\n        if (state.svg)\n          state.svg.dispatch('zoom', { detail: {\n            zoomX: null,\n            zoomY: zoomY,\n            redraw: false\n          }});\n      }\n    },\n    minSegmentDuration: {},\n    zColorScale: { default: d3ScaleSequential(interpolateRdYlBu) },\n    zQualitative: { default: false, onChange(discrete, state) {\n      state.zColorScale = discrete\n        ? d3ScaleOrdinal([...schemeCategory10, ...schemeSet3])\n        : d3ScaleSequential(interpolateRdYlBu); // alt: d3.interpolateInferno\n    }},\n    zDataLabel: { default: '', triggerUpdate: false }, // Units of z data. Used in the tooltip descriptions\n    zScaleLabel: { default: '', triggerUpdate: false }, // Units of colorScale. Used in the legend label\n    enableOverview: { default: true }, // True/False\n    enableAnimations: {\n      default: true,\n      onChange(val, state) {\n        state.transDuration = val?700:0;\n      }\n    },\n\n    // Callbacks\n    onZoom: {}, // When user zooms in / resets zoom. Returns ([startX, endX], [startY, endY])\n    onLabelClick: {}, // When user clicks on a group or y label. Returns (group) or (label, group) respectively\n    onSegmentClick: {} // When user clicks on a segment. Returns (segment object) respectively\n  },\n\n  methods: {\n    getNLines: s => s.nLines,\n    getTotalNLines: s => s.totalNLines,\n    getVisibleStructure: s => s.structData,\n    getSvg: s => d3Select(s.svg.node().parentNode).html(),\n    zoomYLabels(state, _) {\n      if (!_) { return [y2Label(state.zoomY[0]), y2Label(state.zoomY[1])]; }\n      return this.zoomY([label2Y(_[0], true), label2Y(_[1], false)]);\n\n      //\n\n      function y2Label(y) {\n\n        if (y==null) return y;\n\n        let cntDwn = y;\n        for (let i=0, len=state.completeStructData.length; i<len; i++) {\n          if (state.completeStructData[i].lines.length>cntDwn)\n            return getIdxLine(state.completeStructData[i], cntDwn);\n          cntDwn-=state.completeStructData[i].lines.length;\n        }\n\n        // y larger than all lines, return last\n        return getIdxLine(state.completeStructData[state.completeStructData.length-1], state.completeStructData[state.completeStructData.length-1].lines.length-1);\n\n        //\n\n        function getIdxLine(grpData, idx) {\n          return {\n            'group': grpData.group,\n            'label': grpData.lines[idx]\n          };\n        }\n      }\n\n      function label2Y(label, useIdxAfterIfNotFound) {\n\n        useIdxAfterIfNotFound = useIdxAfterIfNotFound || false;\n        const subIdxNotFound = useIdxAfterIfNotFound?0:1;\n\n        if (label==null) return label;\n\n        let idx=0;\n        for (let i=0, lenI=state.completeStructData.length; i<lenI; i++) {\n          const grpCmp = state.grpCmpFunction(label.group, state.completeStructData[i].group);\n          if (grpCmp<0) break;\n          if (grpCmp==0 && label.group==state.completeStructData[i].group) {\n            for (let j=0, lenJ=state.completeStructData[i].lines.length; j<lenJ; j++) {\n              const cmpRes = state.labelCmpFunction(label.label, state.completeStructData[i].lines[j]);\n              if (cmpRes<0) {\n                return idx+j-subIdxNotFound;\n              }\n              if (cmpRes==0 && label.label==state.completeStructData[i].lines[j]) {\n                return idx+j;\n              }\n            }\n            return idx+state.completeStructData[i].lines.length-subIdxNotFound;\n          }\n          idx+=state.completeStructData[i].lines.length;\n        }\n        return idx-subIdxNotFound;\n      }\n    },\n    sort(state, labelCmpFunction, grpCmpFunction) {\n      if (labelCmpFunction==null) { labelCmpFunction = state.labelCmpFunction }\n      if (grpCmpFunction==null) { grpCmpFunction = state.grpCmpFunction }\n\n      state.labelCmpFunction = labelCmpFunction;\n      state.grpCmpFunction = grpCmpFunction;\n\n      state.completeStructData.sort((a, b) => grpCmpFunction(a.group, b.group));\n\n      for (let i=0, len=state.completeStructData.length;i<len;i++) {\n        state.completeStructData[i].lines.sort(labelCmpFunction);\n      }\n\n      state._rerender();\n\n      return this;\n    },\n    sortAlpha(state, asc) {\n      if (asc==null) { asc=true }\n      const alphaCmp = function (a, b) { return alphaNumCmp(asc?a:b, asc?b:a); };\n      return this.sort(alphaCmp, alphaCmp);\n    },\n    sortChrono(state, asc) {\n      if (asc==null) { asc=true }\n\n      function buildIdx(accessFunction) {\n        const idx = {};\n        for (let i= 0, len=state.completeFlatData.length; i<len; i++ ) {\n          const key = accessFunction(state.completeFlatData[i]);\n          if (idx.hasOwnProperty(key)) { continue; }\n\n          const itmList = state.completeFlatData.filter(d => key == accessFunction(d));\n          idx[key] = [\n            d3Min(itmList, d => d.timeRange[0]),\n            d3Max(itmList, d => d.timeRange[1])\n          ];\n        }\n        return idx;\n      }\n\n      const timeCmp = function (a, b) {\n\n        const aT = a[1], bT=b[1];\n\n        if (!aT || !bT) return null; // One of the two vals is null\n\n        if (aT[1].getTime()==bT[1].getTime()) {\n          if (aT[0].getTime()==bT[0].getTime()) {\n            return alphaNumCmp(a[0],b[0]); // If first and last is same, use alphaNum\n          }\n          return aT[0]-bT[0];   // If last is same, earliest first wins\n        }\n        return bT[1]-aT[1]; // latest last wins\n      };\n\n      function getCmpFunction(accessFunction, asc) {\n        return (a, b) => timeCmp(accessFunction(asc?a:b), accessFunction(asc?b:a));\n      }\n\n      const grpIdx = buildIdx(d => d.group);\n      const lblIdx = buildIdx(d => d.label);\n\n      const grpCmp = getCmpFunction(d => [d, grpIdx[d] || null], asc);\n      const lblCmp = getCmpFunction(d => [d, lblIdx[d] || null], asc);\n\n      return this.sort(lblCmp, grpCmp);\n    },\n    overviewDomain(state, _) {\n      if (!state.enableOverview) { return null; }\n\n      if (!_) { return state.overviewArea.domainRange(); }\n      state.overviewArea.domainRange(_);\n      return this;\n    },\n    refresh(state) {\n      state._rerender();\n      return this;\n    }\n  },\n\n  stateInit: {\n    height: null,\n    overviewHeight: 20, // Height of overview section in bottom\n    minLabelFont: 2,\n    groupBkgGradient: ['#FAFAFA', '#E0E0E0'],\n\n    yScale: null,\n    grpScale: null,\n\n    xAxis: null,\n    xGrid: null,\n    yAxis: null,\n    grpAxis: null,\n\n    dateMarkerLine: null,\n\n    svg: null,\n    graph: null,\n    overviewAreaElem: null,\n    overviewArea: null,\n\n    graphW: null,\n    graphH: null,\n\n    completeStructData: null,\n    structData: null,\n    completeFlatData: null,\n    flatData: null,\n    totalNLines: null,\n    nLines: null,\n\n    minSegmentDuration: 0, // ms\n\n    transDuration: 700,   // ms for transition duration\n\n    labelCmpFunction: alphaNumCmp,\n    grpCmpFunction: alphaNumCmp\n  },\n\n  init(el, state) {\n    const elem = d3Select(el)\n      .attr('class', 'timelines-chart');\n\n    state.svg = elem.append('svg');\n    state.overviewAreaElem = elem.append('div');\n\n    // Initialize scales and axes\n    state.yScale = d3ScalePoint();\n    state.grpScale = d3ScaleOrdinal();\n    state.xAxis = d3AxisBottom();\n    state.xGrid = d3AxisTop();\n    state.yAxis = d3AxisRight();\n    state.grpAxis = d3AxisLeft();\n\n    buildDomStructure();\n    addTooltips();\n    addZoomSelection();\n    setEvents();\n    //\n\n    function buildDomStructure () {\n\n      state.yScale.invert = invertOrdinal;\n      state.grpScale.invert = invertOrdinal;\n\n      state.groupGradId = Gradient()\n        .colorScale(d3ScaleLinear()\n          .domain([0,1])\n          .range(state.groupBkgGradient))\n        .angle(-90)\n        (state.svg.node())\n        .id();\n\n      const axises = state.svg.append('g').attr('class', 'axises');\n      axises.append('g').attr('class', 'x-axis')\n      axises.append('g').attr('class', 'x-grid');\n      axises.append('g').attr('class', 'y-axis');\n      axises.append('g').attr('class', 'grp-axis')\n      state.yAxis.scale(state.yScale)\n        .tickSize(0);\n\n      state.grpAxis.scale(state.grpScale)\n        .tickSize(0);\n\n      state.colorLegend = ColorLegend()\n        (state.svg.append('g')\n          .attr('class', 'legendG')\n          .node()\n        );\n\n      state.graph = state.svg.append('g');\n      \n      state.dateMarkerLine = state.svg.append('line').attr('class', 'x-axis-date-marker');\n\n      if (state.enableOverview) {\n        addOverviewArea();\n      }\n\n      // Applies to ordinal scales (invert not supported in d3)\n      function invertOrdinal(val, cmpFunc) {\n        cmpFunc = cmpFunc || function (a, b) {\n            return (a >= b);\n          };\n\n        const scDomain = this.domain();\n        let scRange = this.range();\n\n        if (scRange.length === 2 && scDomain.length !== 2) {\n          // Special case, interpolate range vals\n          scRange = d3Range(scRange[0], scRange[1], (scRange[1] - scRange[0]) / scDomain.length);\n        }\n\n        const bias = scRange[0];\n        for (let i = 0, len = scRange.length; i < len; i++) {\n          if (cmpFunc(scRange[i] + bias, val)) {\n            return scDomain[Math.round(i * scDomain.length / scRange.length)];\n          }\n        }\n\n        return this.domain()[this.domain().length-1];\n      }\n\n      function addOverviewArea() {\n        state.overviewArea = TimeOverview()\n          .margins({ top: 1, right: 20, bottom: 20, left: 20 })\n          .onChange((startTime, endTime) => {\n            state.svg.dispatch('zoom', { detail: {\n              zoomX: [startTime, endTime],\n              zoomY: null\n            }});\n          })\n          .domainRange(state.zoomX)\n          .currentSelection(state.zoomX)\n          (state.overviewAreaElem.node());\n\n        state.svg.on('zoomScent', function() {\n          const zoomX = d3Event.detail.zoomX;\n\n          if (!state.overviewArea || !zoomX) return;\n\n          // Out of overview bounds > extend it\n          if (zoomX[0]<state.overviewArea.domainRange()[0] || zoomX[1]>state.overviewArea.domainRange()[1]) {\n            state.overviewArea.domainRange([\n              new Date(Math.min(zoomX[0], state.overviewArea.domainRange()[0])),\n              new Date(Math.max(zoomX[1], state.overviewArea.domainRange()[1]))\n            ]);\n          }\n\n          state.overviewArea.currentSelection(zoomX);\n        });\n      }\n    }\n\n    function addTooltips() {\n\n      state.groupTooltip = d3Tip()\n        .attr('class', 'chart-tooltip group-tooltip')\n        .direction('w')\n        .offset([0, 0])\n        .style('font-family', \"Montserrat, Helvetica, Arial, sans-serif, serif\")\n        .style(\"font-size\", \"14px\")\n        .html(d => {          \n          const leftPush = (d.hasOwnProperty('timeRange')\n            ?state.xScale(d.timeRange[0])\n            :0\n          );\n          const topPush = (d.hasOwnProperty('label')\n            ?state.grpScale(d.group)-state.yScale(d.group+'+&+'+d.label)\n            :0\n          );\n          state.groupTooltip.offset([topPush, -leftPush]);\n          return d.group;\n        });\n\n      state.svg.call(state.groupTooltip);\n\n      state.lineTooltip = d3Tip()\n        .attr('class', 'chart-tooltip line-tooltip')\n        .direction('e')\n        .offset([0, 0])\n        .style(\"font-size\", \"14px\")\n        .style('font-family', \"Montserrat, Helvetica, Arial, sans-serif, serif\")\n        .html(d => {\n          const rightPush = (d.hasOwnProperty('timeRange')?state.xScale.range()[1]-state.xScale(d.timeRange[1]):0);\n          state.lineTooltip.offset([0, rightPush]);\n          return d.label;\n        });\n\n      state.svg.call(state.lineTooltip);\n\n      state.segmentTooltip = d3Tip()\n        .attr('class', 'chart-tooltip segment-tooltip')\n        .direction('s')\n        .offset([5, 0])\n        .style(\"font-size\", \"14px\")\n        .style('font-family', \"Montserrat, Helvetica, Arial, sans-serif, serif\")\n        .html(d => {\n          const normVal = state.zColorScale.domain()[state.zColorScale.domain().length-1] - state.zColorScale.domain()[0];\n          const dateFormat = (state.useUtc ? d3UtcFormat : d3TimeFormat)(`${state.timeFormat}${state.useUtc?' (UTC)':''}`);\n          return '<strong>' + d.labelVal + ' </strong>' + state.zDataLabel\n            + (normVal?' (<strong>' + Math.round((d.val-state.zColorScale.domain()[0])/normVal*100*100)/100 + '%</strong>)':'') + '<br>'\n            + '<strong>From: </strong>' + dateFormat(d.timeRange[0]) + '<br>'\n            + '<strong>To: </strong>' + dateFormat(d.timeRange[1]);\n        });\n\n      state.svg.call(state.segmentTooltip);\n    }\n\n    function addZoomSelection() {\n      state.graph.on('mousedown', function() {\n        if (d3Select(window).on('mousemove.zoomRect')!=null) // Selection already active\n          return;\n\n        const e = this;\n\n        if (d3Mouse(e)[0]<0 || d3Mouse(e)[0]>state.graphW || d3Mouse(e)[1]<0 || d3Mouse(e)[1]>state.graphH)\n          return;\n\n        state.disableHover=true;\n\n        const rect = state.graph.append('rect')\n          .attr('class', 'chart-zoom-selection');\n\n        const startCoords = d3Mouse(e);\n\n        d3Select(window)\n          .on('mousemove.zoomRect', function() {\n            d3Event.stopPropagation();\n            const newCoords = [\n              Math.max(0, Math.min(state.graphW, d3Mouse(e)[0])),\n              Math.max(0, Math.min(state.graphH, d3Mouse(e)[1]))\n            ];\n            rect.attr('x', Math.min(startCoords[0], newCoords[0]))\n              .attr('y', Math.min(startCoords[1], newCoords[1]))\n              .attr('width', Math.abs(newCoords[0] - startCoords[0]))\n              .attr('height', Math.abs(newCoords[1] - startCoords[1]));\n\n            state.svg.dispatch('zoomScent', { detail: {\n              zoomX: [startCoords[0], newCoords[0]].sort(d3Ascending).map(state.xScale.invert),\n              zoomY: [startCoords[1], newCoords[1]].sort(d3Ascending).map(d =>\n                state.yScale.domain().indexOf(state.yScale.invert(d))\n                + ((state.zoomY && state.zoomY[0])?state.zoomY[0]:0)\n              )\n            }});\n          })\n          .on('mouseup.zoomRect', function() {\n            d3Select(window).on('mousemove.zoomRect', null).on('mouseup.zoomRect', null);\n            d3Select('body').classed('stat-noselect', false);\n            rect.remove();\n            state.disableHover=false;\n\n            const endCoords = [\n              Math.max(0, Math.min(state.graphW, d3Mouse(e)[0])),\n              Math.max(0, Math.min(state.graphH, d3Mouse(e)[1]))\n            ];\n\n            if (startCoords[0]==endCoords[0] && startCoords[1]==endCoords[1])\n              return;\n\n            const newDomainX = [startCoords[0], endCoords[0]].sort(d3Ascending).map(state.xScale.invert);\n\n            const newDomainY = [startCoords[1], endCoords[1]].sort(d3Ascending).map(d =>\n              state.yScale.domain().indexOf(state.yScale.invert(d))\n              + ((state.zoomY && state.zoomY[0])?state.zoomY[0]:0)\n            );\n\n            const changeX=((newDomainX[1] - newDomainX[0])>(60*1000)); // Zoom damper\n            const changeY=(newDomainY[0]!=state.zoomY[0] || newDomainY[1]!=state.zoomY[1]);\n\n            if (changeX || changeY) {\n              state.svg.dispatch('zoom', { detail: {\n                zoomX: changeX?newDomainX:null,\n                zoomY: changeY?newDomainY:null\n              }});\n            }\n          }, true);\n\n        d3Event.stopPropagation();\n      });\n\n      state.resetBtn = state.svg.append('text')\n        .attr('class', 'reset-zoom-btn')\n        .text('Reset Zoom')\n        .style('text-anchor', 'end')\n        .on('mouseup' , function() {\n          state.svg.dispatch('resetZoom');\n        })\n        .on('mouseover', function(){\n          d3Select(this).style('opacity', 1);\n        })\n        .on('mouseout', function() {\n          d3Select(this).style('opacity', .6);\n        });\n    }\n\n    function setEvents() {\n\n      state.svg.on('zoom', function() {\n        const evData = d3Event.detail,\n          zoomX = evData.zoomX,\n          zoomY = evData.zoomY,\n          redraw = (evData.redraw==null)?true:evData.redraw;\n\n        if (!zoomX && !zoomY) return;\n\n        if (zoomX) state.zoomX=zoomX;\n        if (zoomY) state.zoomY=zoomY;\n\n        state.svg.dispatch('zoomScent', { detail: {\n          zoomX: zoomX,\n          zoomY: zoomY\n        }});\n\n        if (!redraw) return;\n\n        state._rerender();\n        if (state.onZoom) state.onZoom(state.zoomX, state.zoomY);\n      });\n\n      state.svg.on('resetZoom', function() {\n        const prevZoomX = state.zoomX;\n        const prevZoomY = state.zoomY || [null, null];\n\n        const newZoomX = state.enableOverview\n          ?state.overviewArea.domainRange()\n          :[\n            d3Min(state.flatData, d => d.timeRange[0]),\n            d3Max(state.flatData, d => d.timeRange[1])\n          ],\n          newZoomY = [null, null];\n\n        if (prevZoomX[0]<newZoomX[0] || prevZoomX[1]>newZoomX[1]\n          || prevZoomY[0]!=newZoomY[0] || prevZoomY[1]!=newZoomX[1]) {\n\n          state.zoomX = [\n            new Date(Math.min(prevZoomX[0],newZoomX[0])),\n            new Date(Math.max(prevZoomX[1],newZoomX[1]))\n          ];\n          state.zoomY = newZoomY;\n          state.svg.dispatch('zoomScent', { detail: {\n            zoomX: state.zoomX,\n            zoomY: state.zoomY\n          }});\n\n          state._rerender();\n        }\n\n        if (state.onZoom) state.onZoom(null, null);\n      });\n    }\n  },\n\n  update(state) {\n\n    applyFilters();\n    setupDimensions();\n\n    adjustXScale();\n    adjustYScale();\n    adjustGrpScale();\n\n    renderAxises();\n    renderGroups();\n\n    renderTimelines();\n    adjustLegend();\n\n    updateBorder();\n\n    //\n\n    function applyFilters() {\n      // Flat data based on segment length\n      state.flatData = (state.minSegmentDuration>0\n        ? state.completeFlatData.filter(d => (d.timeRange[1]-d.timeRange[0]) >= state.minSegmentDuration)\n        : state.completeFlatData\n      );\n\n      // zoomY\n      if (state.zoomY==null || state.zoomY==[null, null]) {\n        state.structData = state.completeStructData;\n        state.nLines=0;\n        for (let i=0, len=state.structData.length; i<len; i++) {\n          state.nLines += state.structData[i].lines.length;\n        }\n        return;\n      }\n\n      state.structData = [];\n      const cntDwn = [state.zoomY[0]==null?0:state.zoomY[0]]; // Initial threshold\n      cntDwn.push(Math.max(0, (state.zoomY[1]==null?state.totalNLines:state.zoomY[1]+1)-cntDwn[0])); // Number of lines\n      state.nLines = cntDwn[1];\n      for (let i=0, len=state.completeStructData.length; i<len; i++) {\n\n        let validLines = state.completeStructData[i].lines;\n\n        if(state.minSegmentDuration>0) {  // Use only non-filtered (due to segment length) groups/labels\n          if (!state.flatData.some(d => d.group == state.completeStructData[i].group)) {\n            continue; // No data for this group\n          }\n\n          validLines = state.completeStructData[i].lines\n            .filter(d => state.flatData.some(dd =>\n              dd.group == state.completeStructData[i].group && dd.label == d\n            )\n          );\n        }\n\n        if (cntDwn[0]>=validLines.length) { // Ignore whole group (before start)\n          cntDwn[0]-=validLines.length;\n          continue;\n        }\n\n        const groupData = {\n          group: state.completeStructData[i].group,\n          lines: null\n        };\n\n        if (validLines.length-cntDwn[0]>=cntDwn[1]) {  // Last (or first && last) group (partial)\n          groupData.lines = validLines.slice(cntDwn[0],cntDwn[1]+cntDwn[0]);\n          state.structData.push(groupData);\n          cntDwn[1]=0;\n          break;\n        }\n\n        if (cntDwn[0]>0) {  // First group (partial)\n          groupData.lines = validLines.slice(cntDwn[0]);\n          cntDwn[0]=0;\n        } else {  // Middle group (full fit)\n          groupData.lines = validLines;\n        }\n\n        state.structData.push(groupData);\n        cntDwn[1]-=groupData.lines.length;\n      }\n\n      state.nLines-=cntDwn[1];\n    }\n\n    function setupDimensions() {\n      state.graphW = state.width-state.leftMargin-state.rightMargin;\n      state.graphH = d3Min([state.nLines*state.maxLineHeight, state.maxHeight-state.topMargin-state.bottomMargin]);\n      state.height = parseInt(state.graphH) + parseInt(state.topMargin) + parseInt(state.bottomMargin);\n\n      state.svg.transition().duration(state.transDuration)\n        .attr('width', state.width)\n        .attr('height', state.height);\n\n      state.graph.attr('transform', 'translate(' + state.leftMargin + ',' + state.topMargin + ')');\n\n      if (state.overviewArea) {\n        state.overviewArea\n          .width(state.width * 0.8)\n          .height(state.overviewHeight + state.overviewArea.margins().top + state.overviewArea.margins().bottom);\n      }\n    }\n\n    function adjustXScale() {\n      state.zoomX[0] = state.zoomX[0] || d3Min(state.flatData, d => d.timeRange[0]);\n      state.zoomX[1] = state.zoomX[1] || d3Max(state.flatData, d => d.timeRange[1]);\n\n      state.xScale = (state.useUtc ? d3ScaleUtc : d3ScaleTime)()\n        .domain(state.zoomX)\n        .range([0, state.graphW])\n        .clamp(true);\n\n      if (state.overviewArea) {\n        state.overviewArea\n          .scale(state.xScale.copy())\n          .tickFormat(state.xTickFormat);\n      }\n    }\n\n    function adjustYScale() {\n      let labels = [];\n      for (let i= 0, len=state.structData.length; i<len; i++) {\n        labels = labels.concat(state.structData[i].lines.map(function (d) {\n          return state.structData[i].group + '+&+' + d\n        }));\n      }\n\n      state.yScale.domain(labels);\n      state.yScale.range([state.graphH/labels.length*0.5, state.graphH*(1-0.5/labels.length)]);\n    }\n\n    function adjustGrpScale() {\n      state.grpScale.domain(state.structData.map(d => d.group));\n\n      let cntLines=0;\n      state.grpScale.range(state.structData.map(d => {\n        const pos = (cntLines+d.lines.length/2)/state.nLines*state.graphH;\n        cntLines+=d.lines.length;\n        return pos;\n      }));\n    }\n\n    function adjustLegend() {\n      state.svg.select('.legendG')\n        .transition().duration(state.transDuration)\n          .attr('transform', `translate(${parseInt(state.leftMargin)},2)`);\n\n      \n\n      state.colorLegend\n        .width(Math.max(120, state.graphW/3 * (state.zQualitative?2:1)))\n        .height(state.topMargin*.6)\n        .scale(state.zColorScale)\n        .label(state.zScaleLabel);\n\n      state.resetBtn\n        .transition().duration(state.transDuration)\n          .attr('x', parseInt(state.leftMargin) + parseInt(state.graphW)*.99)\n          .attr('y', state.topMargin *.8);\n\n      TextFitToBox()\n        .bbox({\n          width: state.graphW *.4,\n          height: Math.min(13,state.topMargin *.8)\n        })\n        (state.resetBtn.node());\n    }\n\n    function renderAxises() {\n\n      state.svg.select('.axises')\n        .attr('transform', 'translate(' + state.leftMargin + ',' + state.topMargin + ')');\n\n      // X\n      state.xAxis\n        .scale(state.xScale)\n        .ticks(Math.round(state.graphW*0.0011))\n        .tickFormat(state.xTickFormat);\n      state.xGrid\n        .scale(state.xScale)\n        .ticks(state.xAxis.ticks()[0])\n        .tickFormat('');\n\n      state.svg.select('g.x-axis')\n        .style('stroke-opacity', 0)\n        .style('fill-opacity', 0)\n        .style(\"font-weight\", \"900\")\n        .style(\"font-size\", \"14px\")\n        .style('font-family', \"Montserrat, Helvetica, Arial, sans-serif, serif\")\n        .attr('transform', 'translate(0,' + state.graphH + ')')\n        .transition().duration(state.transDuration)\n          .call(state.xAxis)\n          .style('stroke-opacity', 1)\n          .style('fill-opacity', 1);\n\n      /* Angled x axis labels\n       state.svg.select('g.x-axis').selectAll('text')\n       .style('text-anchor', 'end')\n       .attr('transform', 'translate(-10, 3) rotate(-60)');\n       */\n\n      state.xGrid.tickSize(state.graphH);\n      state.svg.select('g.x-grid')\n        .attr('transform', 'translate(0,' + state.graphH + ')')\n        .transition().duration(state.transDuration)\n        .call(state.xGrid);\n\n      if (\n        state.dateMarker &&\n        state.dateMarker >= state.xScale.domain()[0] &&\n        state.dateMarker <= state.xScale.domain()[1]\n      ) {\n        state.dateMarkerLine\n          .style('display', 'block')\n          .transition().duration(state.transDuration)\n            .attr('x1', state.xScale(state.dateMarker) + state.leftMargin)\n            .attr('x2', state.xScale(state.dateMarker) + state.leftMargin)\n            .attr('y1', parseInt(state.topMargin) + 1)\n            .attr('y2', parseInt(state.graphH) + parseInt(state.topMargin))\n      } else {\n        state.dateMarkerLine.style('display', 'none');\n      }\n\n      // Y\n      const fontVerticalMargin = 0.6;\n      const labelDisplayRatio = Math.ceil(state.nLines*state.minLabelFont/Math.sqrt(2)/state.graphH/fontVerticalMargin);\n      const tickVals = state.yScale.domain().filter((d, i) => !(i % labelDisplayRatio));\n      let fontSize = Math.min(12, state.graphH/tickVals.length*fontVerticalMargin*Math.sqrt(2));\n      let maxChars = Math.ceil(state.rightMargin/(fontSize/Math.sqrt(2)));\n\n      state.yAxis.tickValues(tickVals);\n      state.yAxis.tickFormat(d => reduceLabel(d.split('+&+')[1], maxChars));\n      state.svg.select('g.y-axis')\n        .transition().duration(state.transDuration)\n          .attr('transform', 'translate(' + state.graphW + ', 0)')\n          .style('font-size', fontSize + 'px')\n          .style('font-family', \"Montserrat, Helvetica, Arial, sans-serif, serif\")\n          .call(state.yAxis);\n\n      // Grp\n      const minHeight = d3Min(state.grpScale.range(), function (d,i) {\n        return i>0?d-state.grpScale.range()[i-1]:d*2;\n      });\n      fontSize = Math.min(14, minHeight*fontVerticalMargin*Math.sqrt(2));\n      maxChars = Math.floor(state.leftMargin/(fontSize/Math.sqrt(2)));\n\n      state.grpAxis.tickFormat(d => reduceLabel(d, maxChars));\n      state.svg.select('g.grp-axis')\n        .transition().duration(state.transDuration)\n        .style('font-size', fontSize + 'px')\n        .style('font-family', \"Montserrat, Helvetica, Arial, sans-serif, serif\")\n        .call(state.grpAxis);\n\n      // Make Axises clickable\n      if (state.onLabelClick) {\n        state.svg.selectAll('g.y-axis,g.grp-axis').selectAll('text')\n          .style('cursor', 'pointer')\n          .on('click', function(d) {\n            const segms = d.split('+&+');\n            state.onLabelClick(...segms.reverse());\n          });\n      }\n\n      //\n\n      function reduceLabel(label, maxChars) {\n        return label.length<=maxChars?label:(\n          label.substring(0, maxChars*2/3)\n          + '...'\n          + label.substring(label.length - maxChars/3, label.length\n        ));\n      }\n    }\n\n    function renderGroups() {\n\n      let groups = state.graph.selectAll('rect.series-group').data(state.structData, d => {\n        return d.group\n      });\n\n      groups.exit()\n        .transition().duration(state.transDuration)\n        .style('stroke-opacity', 0)\n        .style('fill-opacity', 0)\n        .remove();\n \n      const newGroups = groups.enter().append('rect')\n        .attr('class', 'series-group')\n        .attr('x', 0)\n        .attr('y', 0)\n        .attr('height', 0)\n        .style('fill', 'url(#' + state.groupGradId + ')')\n        .on('mouseover', (d, index, element) => {\n          const groupAxis = d3Select(\".grp-axis\").selectAll(\"g\")\n          groupAxis.style(\"opacity\", 0.1)\n\n          const yRightAxis = d3Select(\".y-axis\").selectAll(\"g\")\n          yRightAxis.style(\"opacity\",0.1)\n          state.groupTooltip.show(d, element[index])\n        })\n        .on('mouseout',(d, index, element) => {\n          const groupAxis = d3Select(\".grp-axis\").selectAll(\"g\")\n          groupAxis.style(\"opacity\", 1)\n\n          const yRightAxis = d3Select(\".y-axis\").selectAll(\"g\")\n          yRightAxis.style(\"opacity\",1)\n\n          state.groupTooltip.hide(d,element[index])\n        });\n\n      newGroups.append('title')\n        .text('click-drag to zoom in');\n\n      groups = groups.merge(newGroups);\n\n      groups.transition().duration(state.transDuration)\n        .attr('width', state.graphW)\n        .attr('height', function (d) {\n          return ((state.graphH)*(d.lines.length)/state.nLines) ;\n        })\n        .attr('y', function (d, index) {\n          return parseFloat(state.grpScale(d.group)-state.graphH*d.lines.length/state.nLines/2)\n            ;\n        });\n    }\n\n    function renderTimelines(maxElems) {\n\n      if (maxElems<0) maxElems=null;\n\n      const hoverEnlargeRatio = .4;\n\n      const dataFilter = (d, i) =>\n        (maxElems==null || i<maxElems) &&\n        (state.grpScale.domain().indexOf(d.group)+1 &&\n        d.timeRange[1]>=state.xScale.domain()[0] &&\n        d.timeRange[0]<=state.xScale.domain()[1] &&\n        state.yScale.domain().indexOf(d.group+'+&+'+d.label)+1);\n\n      state.lineHeight = state.graphH/state.nLines*0.8;\n\n      let timelines = state.graph.selectAll('rect.series-segment').data(\n        state.flatData.filter(dataFilter),\n        d => d.group + d.label + d.timeRange[0]\n      );\n\n      timelines.exit()\n        .transition().duration(state.transDuration)\n        .style('fill-opacity', 0)\n        .remove();\n      const newSegments = timelines.enter().append('rect')\n        .attr('class', 'series-segment')\n        .attr('rx', 1)\n        .attr('ry', 1)\n        .attr('x', state.graphW/2)\n        .attr('y', state.graphH/2)\n        .attr('width', 0)\n        .attr('height', 0)\n        .style('fill', d => state.zColorScale(d.val))\n        .style('fill-opacity', 0)\n        .on('mouseover.groupTooltip', state.groupTooltip.show)\n        .on('mouseout.groupTooltip', state.groupTooltip.hide)\n        // .on('mouseover.lineTooltip', state.lineTooltip.show)\n        // .on('mouseout.lineTooltip', state.lineTooltip.hide)\n        .on('mouseover.lineTooltip', (d, index, element) => {\n          const groupAxis = d3Select(\".grp-axis\").selectAll(\"g\")\n          groupAxis.style(\"opacity\", 0.1)\n\n          const yRightAxis = d3Select(\".y-axis\").selectAll(\"g\")\n          yRightAxis.style(\"opacity\",0.1)\n          state.lineTooltip.show(d, element[index])\n          state.groupTooltip.show(d,element[index])\n        })\n        .on('mouseout.lineTooltip',(d, index, element) => {\n          const groupAxis = d3Select(\".grp-axis\").selectAll(\"g\")\n          groupAxis.style(\"opacity\", 1)\n\n          const yRightAxis = d3Select(\".y-axis\").selectAll(\"g\")\n          yRightAxis.style(\"opacity\",1)\n\n          state.lineTooltip.hide(d,element[index])\n          state.groupTooltip.hide(d,element[index])\n        })\n        .on('mouseover.segmentTooltip', state.segmentTooltip.show)\n        .on('mouseout.segmentTooltip', state.segmentTooltip.hide);\n\n      newSegments\n        .on('mouseover', function() {\n          if ('disableHover' in state && state.disableHover)\n            return;\n\n          MoveToFront()(this);\n\n          const hoverEnlarge = state.lineHeight*hoverEnlargeRatio;\n\n          d3Select(this)\n            .transition().duration(70)\n            .attr('x', function (d) {\n              return state.xScale(d.timeRange[0])-hoverEnlarge/2;\n            })\n            .attr('width', function (d) {\n              return d3Max([1, state.xScale(d.timeRange[1])-state.xScale(d.timeRange[0])])+hoverEnlarge;\n            })\n            .attr('y', function (d) {\n              return state.yScale(d.group+'+&+'+d.label)-(state.lineHeight+hoverEnlarge)/2;\n            })\n            .attr('height', state.lineHeight+hoverEnlarge)\n            .style('fill-opacity', 1);\n        })\n        .on('mouseout', function() {\n          d3Select(this)\n            .transition().duration(250)\n            .attr('x', function (d) {\n              return state.xScale(d.timeRange[0]);\n            })\n            .attr('width', function (d) {\n              return d3Max([1, state.xScale(d.timeRange[1])-state.xScale(d.timeRange[0])]);\n            })\n            .attr('y', function (d) {\n              return state.yScale(d.group+'+&+'+d.label)-state.lineHeight/2;\n            })\n            .attr('height', state.lineHeight)\n            .style('fill-opacity', .8);\n        })\n        .on('click', function (s) {\n          if (state.onSegmentClick)\n            state.onSegmentClick(s);\n        });\n\n      timelines = timelines.merge(newSegments);\n\n      timelines.transition().duration(state.transDuration)\n        .attr('x', function (d) {\n          return state.xScale(d.timeRange[0]);\n        })\n        .attr('width', function (d) {\n          return d3Max([1, state.xScale(d.timeRange[1])-state.xScale(d.timeRange[0])]);\n        })\n        .attr('y', function (d) {\n          return state.yScale(d.group+'+&+'+d.label)-state.lineHeight/2;\n        })\n        .attr('height', state.lineHeight)\n        .style('fill-opacity', .8);\n    }\n\n    function updateBorder(){\n      let numberOfLine = state.xAxis.tickSize() + parseInt(1)\n      console.log(state)\n      const startDate = new Date(state.zoomX[0])\n      const endDate = new Date(state.zoomX[1])\n      const dateDiff = endDate.getTime() - startDate.getTime()\n      const dateDiffInDay = parseInt(dateDiff / (1000 * 60 * 60 * 24))\n      state.graph.selectAll(\"line\")\n      .data(Array(dateDiffInDay))\n      .enter()\n      .append(\"rect\")\n      .attr(\"width\", \"1px\")\n      .attr(\"height\", state.graphH)\n      .attr(\"fill\", \"rgba(0,0,0,0.4)\")\n      .attr(\"transform\", (d,index) => {\n        return `translate(${index * (state.graphW / dateDiffInDay)},0)`\n      })\n        \n    }\n  }\n});\n","import React, { Component } from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport {\n    scaleOrdinal as d3ScaleOrdinal\n} from \"d3-scale\"\n\nimport TimelinesChart from \"./utilities/src/timelines\"\nimport moment from 'moment';\n\nconst KAPAL_PERINTIS_JATIM = \"Kapal Perintis\"\nconst KAPAL_PENGAWAS_KKP = \"Kapal Pengawas\"\nconst BENCHMARKING_BALAI_PANTAI_BALI = \"Balai Pantai Bali\"\nconst LOMBA_OCEANO = \"Lomba Oceano\"\nconst WAHANA_ALPO = \"Wahana Alpo\"\nconst DIPA_HANKAM = \"DIPA Hankam\"\nconst PPT_MARITIM = \"PPT Maritim\"\nconst PPT_INA_TEWS = \"PPT INA-TEWS\"\nconst KPC60 = \"Kapal Patroli Cepat 60M\"\nconst BCM4 = \"Kapal BCM-4\"\nconst FERRYACEH1300 = \"Ferry Aceh 1300GT\"\nconst FERRY1500 = \"Ferry RoRo 1500GT\"\nconst TODAY = \"\"\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n  }\n\n  componentDidMount() {\n    let todayDate = new moment().toDate()\n    let dataJson = [\n      // Produksi \n      {\n        group : \"Produksi\", \n        data : [\n            {\n              label : FERRY1500,\n              data : [\n                  {\n                    timeRange : [new Date(\"Sep 21 2020\"), new Date(\"Sep 25 2020\") ],\n                    val : FERRY1500\n                  }\n              ]\n            },\n\n            {\n              label : FERRYACEH1300,\n              data : [\n                  {\n                    timeRange : [new Date(\"Sep 21 2020\"), new Date(\"Sep 25 2020\") ],\n                    val : FERRYACEH1300\n                  }\n              ]\n            },\n        ]\n      },\n\n\n      // MWS \n      {\n        group : \"Mekanik\", \n        data : [\n            {\n                label : PPT_MARITIM,\n                data : [\n                    {\n                      timeRange : [new Date(\"Sep 21 2020\"), new Date(\"Sep 25 2020\") ],\n                      val : PPT_MARITIM\n                    }\n                ]\n            },\n            {\n                label : PPT_INA_TEWS,\n                data : [\n                    {\n                      timeRange : [new Date(\"Sep 21 2020\"), new Date(\"Sep 25 2020\") ],\n                      val : PPT_INA_TEWS\n                    }\n                ]\n            },\n            {\n                label : KPC60,\n                data : [\n                    {\n                      timeRange : [new Date(\"Sep 21 2020\"), new Date(\"Sep 25 2020\") ],\n                      val : KPC60\n                    }\n                ]\n            },\n            {\n                label : BCM4,\n                data : [\n                    {\n                      timeRange : [new Date(\"Sep 21 2020\"), new Date(\"Sep 25 2020\") ],\n                      val : BCM4\n                    }\n                ]\n            },\n        ]\n      },\n\n      // CNC \n      {\n        group : \"CNC 5-Axis\", \n        data : [\n            {\n                label : KPC60,\n                data : [\n                    {\n                      timeRange : [new Date(\"Sep 21 2020\"), new Date(\"Sep 25 2020\") ],\n                      val : KPC60\n                    }\n                ]\n            }\n        ]\n      },\n\n      // Inskal \n      {\n        group : \"Instrumentasi\", \n        data : [\n            // {\n            //     label : \"Instrumentasi\",\n            //     data : [\n            //         {\n            //             timeRange : [new Date(\"Jul 06 2018\"), new Date(\"Jul 13 2018\") ],\n            //             val : \"Buoy Merah Putih\"\n            //         }\n            //     ]\n            // },\n\n            // {\n            //   label : \"Instrumentasi\",\n            //   data : [\n            //       {\n            //           timeRange : [new Date(\"Sep 02 2018\"), new Date(\"Sep 09 2018\") ],\n            //           val : \"Kapal Patroli Cepat 75 M\"\n            //       }\n            //   ]\n            // },\n\n            // {\n            //   label : \"Instrumentasi\",\n            //   data : [\n            //       {\n            //           timeRange : [new Date(\"Nov 02 2018\"), new Date(\"Nov 05 2018\") ],\n            //           val : \"Kapal Selam\"\n            //       }\n            //   ]\n            // }\n        ]\n      },\n\n      // Towing Tank \n      {\n        group : \"Tow. Tank\", \n        data : [\n            {\n                label : BCM4,\n                data : [\n                    {\n                      timeRange : [new Date(\"Sep 30 2020\"), todayDate ],\n                      val : BCM4\n                    }\n                ]\n            }\n        ]\n      },\n\n      // MOB \n      {\n        group : \"MOB\", \n        data : [\n            {\n                label : FERRYACEH1300,\n                data : [\n                    {\n                      timeRange : [new Date(\"Sep 25 2020\"), new Date(\"Sep 30 2020\") ],\n                      val : FERRYACEH1300\n                    }\n                ]\n            }\n        ]\n      },\n\n      // Cavitation Tunnel \n      {\n        group : \"CT\", \n        data : [\n            {\n                label : TODAY,\n                data : [\n                    {\n                      timeRange : [todayDate, todayDate],\n                      val : KPC60\n                    }\n                ]\n            }\n        ]\n      },\n      \n    ]\n\n    let myColor = d3ScaleOrdinal([],[\"#B22222\", \"#14868C\", \"#FB9224\", \"#D35656\", \"#7f78d2\", \"#42b883\", \"darkgreen\", \"pink\", \"brown\", \"slateblue\", \"grey1\", \"orange\"])\n    let timelinesChart = TimelinesChart()\n\n    console.log(myColor.domain())\n    \n    timelinesChart\n      .data(dataJson)\n      .zQualitative(true)\n      .zColorScale(myColor)\n      .topMargin(\"40\")\n      .width(window.innerWidth)\n      .timeFormat('%Y-%m-%d')\n      .enableOverview(false)\n      (document.getElementById(\"facility-timeline-chart\"))\n  }\n  \n  render() {\n    return (\n      <div id=\"facility-timeline-chart\"></div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}